(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{813:function(_,v,a){"use strict";a.r(v);var t=a(108),e=Object(t.a)({},(function(){var _=this,v=_.$createElement,a=_._self._c||v;return a("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[a("h1",{attrs:{id:"更新日志-master-分支-commit"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更新日志-master-分支-commit"}},[_._v("#")]),_._v(" 更新日志（master 分支 commit）")]),_._v(" "),a("p",[_._v("此文档将显示非发布版的提交版本相关更新文档，可能与发布版的更新日志有重合，在此仅作更新记录。")]),_._v(" "),a("p",[_._v("同时此处将只使用 build 版本号进行区分。")]),_._v(" "),a("h2",{attrs:{id:"build-449-2022-3-21"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-449-2022-3-21"}},[_._v("#")]),_._v(" build 449 (2022-3-21)")]),_._v(" "),a("ul",[a("li",[_._v("新增 Composer 模块加载和分发模式")])]),_._v(" "),a("h2",{attrs:{id:"build-448-2022-3-20"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-448-2022-3-20"}},[_._v("#")]),_._v(" build 448 (2022-3-20)")]),_._v(" "),a("ul",[a("li",[_._v("加快 build 命令的执行速度，取消进度条和提升性能")])]),_._v(" "),a("h2",{attrs:{id:"build-447-2022-3-20"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-447-2022-3-20"}},[_._v("#")]),_._v(" build 447 (2022-3-20)")]),_._v(" "),a("ul",[a("li",[_._v("发布 2.7.0 正式版")])]),_._v(" "),a("h2",{attrs:{id:"build-446-2022-3-20"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-446-2022-3-20"}},[_._v("#")]),_._v(" build 446 (2022-3-20)")]),_._v(" "),a("ul",[a("li",[_._v("新增 "),a("code",[_._v("./zhamao server")]),_._v(" 下的 "),a("code",[_._v("--no-state-check")]),_._v(" 参数，关闭“启动框架前的运行状态检查”功能")])]),_._v(" "),a("h2",{attrs:{id:"build-445-2022-3-20"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-445-2022-3-20"}},[_._v("#")]),_._v(" build 445 (2022-3-20)")]),_._v(" "),a("ul",[a("li",[_._v("新增配置项 "),a("code",[_._v("runtime")]),_._v("."),a("code",[_._v("annotation_reader_ignore")]),_._v("：支持注解解析器忽略注解的自定义")])]),_._v(" "),a("h2",{attrs:{id:"build-444-2022-3-20"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-444-2022-3-20"}},[_._v("#")]),_._v(" build 444 (2022-3-20)")]),_._v(" "),a("ul",[a("li",[_._v("更改 "),a("code",[_._v("extra")]),_._v("."),a("code",[_._v("exclude_annotate")]),_._v(" 为 "),a("code",[_._v("zm")]),_._v("."),a("code",[_._v("exclude-annotation-path")]),_._v(" 项")])]),_._v(" "),a("h2",{attrs:{id:"build-443-2022-3-20"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-443-2022-3-20"}},[_._v("#")]),_._v(" build 443 (2022-3-20)")]),_._v(" "),a("ul",[a("li",[_._v("修复注释空格的样式")])]),_._v(" "),a("h2",{attrs:{id:"build-442-2022-3-20"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-442-2022-3-20"}},[_._v("#")]),_._v(" build 442 (2022-3-20)")]),_._v(" "),a("ul",[a("li",[_._v("修复打包模块后 "),a("code",[_._v("files")]),_._v(" 的 autoload 项不能被解压和引入的 Bug")])]),_._v(" "),a("h2",{attrs:{id:"build-441-2022-3-20"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-441-2022-3-20"}},[_._v("#")]),_._v(" build 441 (2022-3-20)")]),_._v(" "),a("ul",[a("li",[_._v("修复打包模块时命名空间与实际不一致的 Bug")])]),_._v(" "),a("h2",{attrs:{id:"build-440-2022-3-20"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-440-2022-3-20"}},[_._v("#")]),_._v(" build 440 (2022-3-20)")]),_._v(" "),a("ul",[a("li",[_._v("新增方法宏（Macroable）")])]),_._v(" "),a("h2",{attrs:{id:"build-439-2022-3-19"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-439-2022-3-19"}},[_._v("#")]),_._v(" build 439 (2022-3-19)")]),_._v(" "),a("ul",[a("li",[_._v("新增 PHP 8 Attribute 与注解同时支持的特性")])]),_._v(" "),a("h2",{attrs:{id:"build-438-2022-3-18"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-438-2022-3-18"}},[_._v("#")]),_._v(" build 438 (2022-3-18)")]),_._v(" "),a("ul",[a("li",[_._v("修复 Response 类在 PHP 8.1 环境下的报错")])]),_._v(" "),a("h2",{attrs:{id:"build-437-2022-3-17"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-437-2022-3-17"}},[_._v("#")]),_._v(" build 437 (2022-3-17)")]),_._v(" "),a("ul",[a("li",[_._v("修复 "),a("code",[_._v("ctx()")]),_._v(" 可能会返回 null 的 Bug")])]),_._v(" "),a("h2",{attrs:{id:"build-436-2022-3-15"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-436-2022-3-15"}},[_._v("#")]),_._v(" build 436 (2022-3-15)")]),_._v(" "),a("ul",[a("li",[_._v("新增 PHPStan 和 PHP CS Fixer 并优化全局代码")])]),_._v(" "),a("h2",{attrs:{id:"build-435-2022-3-13"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-435-2022-3-13"}},[_._v("#")]),_._v(" build 435 (2022-3-13)")]),_._v(" "),a("ul",[a("li",[_._v("优化分离 WorkerManager 与 ProcessManager 的职责")]),_._v(" "),a("li",[_._v("新增 Ctrl+C 一次无法停止框架时多次 Ctrl+C 后可强行杀掉所有进程的功能")]),_._v(" "),a("li",[a("code",[_._v("./zhamao server:stop")]),_._v(" 新增参数 "),a("code",[_._v("--force")]),_._v("，使用 "),a("code",[_._v("SIGKILL")]),_._v(" 强行杀掉所有进程")]),_._v(" "),a("li",[_._v("新增 AnnotationParser 对 "),a("code",[_._v("autoload-dev")]),_._v(" 项中的 "),a("code",[_._v("psr-4")]),_._v(" 默认检索条件")]),_._v(" "),a("li",[_._v("新增框架启动状态检测功能，如果已经启动了同样目录的框架，则会报错")]),_._v(" "),a("li",[_._v("新增“强制启用轮询模式启动热更新”功能（参数 "),a("code",[_._v("--polling-watch")]),_._v("）")]),_._v(" "),a("li",[_._v("修复与 PHP 8.1 的兼容性")]),_._v(" "),a("li",[_._v("对 DaemonCommand 进行优化，与 ServerCommand 效果相同")]),_._v(" "),a("li",[_._v("修复 "),a("code",[_._v("autoload")]),_._v("."),a("code",[_._v("psr-4")]),_._v(" 不存在时报错的 Bug")]),_._v(" "),a("li",[_._v("新增框架停止时 Worker 退出回显状态码")]),_._v(" "),a("li",[_._v("新增 inotify 判断模式，如果使用 "),a("code",[_._v("--watch")]),_._v(" 检测到没有安装 inotify，则自动使用轮询模式")])]),_._v(" "),a("h2",{attrs:{id:"build-434-2022-1-8"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-434-2022-1-8"}},[_._v("#")]),_._v(" build 434 (2022-1-8)")]),_._v(" "),a("ul",[a("li",[_._v("修复框架在 PHP 8.1 下运行时的一些问题")]),_._v(" "),a("li",[_._v("新增 Console 日志输出到文件的功能")])]),_._v(" "),a("h2",{attrs:{id:"build-433-2021-12-28"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-433-2021-12-28"}},[_._v("#")]),_._v(" build 433 (2021-12-28)")]),_._v(" "),a("ul",[a("li",[_._v("修复 OneBotV11 因 IDE 自动优化导致 API 接口发生变化的问题")])]),_._v(" "),a("h2",{attrs:{id:"build-432-2021-12-25"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-432-2021-12-25"}},[_._v("#")]),_._v(" build 432 (2021-12-25)")]),_._v(" "),a("ul",[a("li",[_._v("新增 GoCqhttpAPI 包，用于支持额外的 OneBot Action（API）")]),_._v(" "),a("li",[_._v("修复 MySQL 查询器中 "),a("code",[_._v("fetchOne()")]),_._v(" 方法无法正确返回值的 Bug")]),_._v(" "),a("li",[_._v("修复 Swoole Hook 因配置不当无法正确使用的 Bug")])]),_._v(" "),a("h2",{attrs:{id:"build-431-2021-12-22"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-431-2021-12-22"}},[_._v("#")]),_._v(" build 431 (2021-12-22)")]),_._v(" "),a("ul",[a("li",[_._v("修复 Issue #50")]),_._v(" "),a("li",[_._v("新增 PhpStorm IDE 直接运行框架的脚本")])]),_._v(" "),a("h2",{attrs:{id:"build-430-2021-12-8"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-430-2021-12-8"}},[_._v("#")]),_._v(" build 430 (2021-12-8)")]),_._v(" "),a("ul",[a("li",[_._v("删除调试信息")]),_._v(" "),a("li",[_._v("修复 #56 中关于数据库组件的 Bug")])]),_._v(" "),a("h2",{attrs:{id:"build-429-2021-12-7"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-429-2021-12-7"}},[_._v("#")]),_._v(" build 429 (2021-12-7)")]),_._v(" "),a("ul",[a("li",[_._v("新增配置项 "),a("code",[_._v("onebot")]),_._v("."),a("code",[_._v("message_command_policy")])]),_._v(" "),a("li",[_._v("新增 CQCommand 阻断策略的自定义配置功能")]),_._v(" "),a("li",[_._v("修复 CQAfter 无法正常使用的 bug #53")])]),_._v(" "),a("h2",{attrs:{id:"build-428-2021-11-16"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-428-2021-11-16"}},[_._v("#")]),_._v(" build 428 (2021-11-16)")]),_._v(" "),a("ul",[a("li",[_._v("修复 "),a("code",[_._v("ctx()->waitMessage()")]),_._v(" 在 array 消息模式下无法正确返回消息字符串的问题")]),_._v(" "),a("li",[_._v("新增 "),a("code",[_._v("ctx()->getArrayMessage()")]),_._v(" 和 "),a("code",[_._v("ctx()->getStringMessage()")]),_._v(" 两个方法")]),_._v(" "),a("li",[_._v("修复注解事件 "),a("code",[_._v("CQCommand")]),_._v(" 和 "),a("code",[_._v("CQMessage")]),_._v(" 在 array 消息模式下无法正确解析的 Bug")])]),_._v(" "),a("h2",{attrs:{id:"build-427-2021-11-16"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-427-2021-11-16"}},[_._v("#")]),_._v(" build 427 (2021-11-16)")]),_._v(" "),a("ul",[a("li",[_._v("新增全局中间件，可在全局配置文件中设置")]),_._v(" "),a("li",[_._v("修复部分 Typo")]),_._v(" "),a("li",[_._v("新增指令 "),a("code",[_._v("server:status")]),_._v("、"),a("code",[_._v("server:reload")]),_._v("、"),a("code",[_._v("server:stop")]),_._v(" 可用在新开终端中查看框架运行状态、重启和退出")]),_._v(" "),a("li",[_._v("新增支持 "),a("code",[_._v("array")]),_._v(" 格式的消息")]),_._v(" "),a("li",[_._v("上下文 Context 对象新增 "),a("code",[_._v("getOriginMessage()")]),_._v(" 用于获取原消息，"),a("code",[_._v("getMessage()")]),_._v(" 如果在设置了转换后，将默认转换消息为字符串格式保持与旧模块兼容")]),_._v(" "),a("li",[_._v("OneBot API 新增全局过滤器，可用作 Action 过滤重写等操作")]),_._v(" "),a("li",[_._v("配置文件新增 "),a("code",[_._v("runtime.reload_delay_time")]),_._v("，用于可配置重载 Worker 等待的时间（毫秒）")]),_._v(" "),a("li",[_._v("配置文件新增 "),a("code",[_._v("runtime.global_middleware_binding")]),_._v("，用于配置全局中间件")]),_._v(" "),a("li",[_._v("配置文件新增 "),a("code",[_._v("onebot.message_convert_string")]),_._v("，用于配置是否转换数组格式为字符串，保证与前版本的兼容性（默认为 true）")]),_._v(" "),a("li",[_._v("MessageUtil 消息工具类新增方法："),a("code",[_._v("strToArray($msg, bool $ignore_space = true, bool $trim_text = false)")])]),_._v(" "),a("li",[_._v("MessageUtil 消息工具类新增方法："),a("code",[_._v("arrayToStr(array $array)")])]),_._v(" "),a("li",[_._v("新增框架启动多次监测功能，无法使用同一个框架项目同时启动两个框架")])]),_._v(" "),a("h2",{attrs:{id:"build-426-2021-11-10"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-426-2021-11-10"}},[_._v("#")]),_._v(" build 426 (2021-11-10)")]),_._v(" "),a("ul",[a("li",[_._v("修复 CQ 码的解析函数 Bug（#52）")])]),_._v(" "),a("h2",{attrs:{id:"build-425-2021-11-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-425-2021-11-3"}},[_._v("#")]),_._v(" build 425 (2021-11-3)")]),_._v(" "),a("ul",[a("li",[_._v("删除未实际应用功能的配置参数")]),_._v(" "),a("li",[_._v("修复 reload 时会断开 WebSocket 连接且导致进程崩溃的 Bug")])]),_._v(" "),a("h2",{attrs:{id:"build-424-2021-11-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-424-2021-11-2"}},[_._v("#")]),_._v(" build 424 (2021-11-2)")]),_._v(" "),a("ul",[a("li",[_._v("新增 InstantModule 类、ZMServer 类、ModuleBase 类")]),_._v(" "),a("li",[_._v("配置文件新增 "),a("code",[_._v("runtime.reload_kill_connect")]),_._v("、"),a("code",[_._v("runtime.global_middleware_binding")]),_._v(" 选项")]),_._v(" "),a("li",[_._v("修复部分情况下闭包事件分发时崩溃的 bug")]),_._v(" "),a("li",[_._v("新增内部方法 "),a("code",[_._v("_zm_env_check")])]),_._v(" "),a("li",[_._v("调整默认的 OneBot 模块对应的等级从 99999 调整为 99")]),_._v(" "),a("li",[_._v("新增导出框架运行参数的列表功能")])]),_._v(" "),a("h2",{attrs:{id:"build-423-2021-10-17"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-423-2021-10-17"}},[_._v("#")]),_._v(" build 423 (2021-10-17)")]),_._v(" "),a("ul",[a("li",[_._v("修复 PHP 7.2 ~ 7.3 下无法使用新版 MySQL 组件的 bug")])]),_._v(" "),a("h2",{attrs:{id:"build-422-2021-10-6"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-422-2021-10-6"}},[_._v("#")]),_._v(" build 422 (2021-10-6)")]),_._v(" "),a("ul",[a("li",[_._v("修复 "),a("code",[_._v("script_")]),_._v(" 前缀无法被排除加载模块的 bug")]),_._v(" "),a("li",[_._v("修复 MySQL 组件的依赖问题")])]),_._v(" "),a("h2",{attrs:{id:"build-421-2021-9-11"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-421-2021-9-11"}},[_._v("#")]),_._v(" build 421 (2021-9-11)")]),_._v(" "),a("ul",[a("li",[_._v("删除多余的调试信息")])]),_._v(" "),a("h2",{attrs:{id:"build-420-2021-9-11"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-420-2021-9-11"}},[_._v("#")]),_._v(" build 420 (2021-9-11)")]),_._v(" "),a("ul",[a("li",[_._v("修复 OneBot 事件无法响应的 bug")]),_._v(" "),a("li",[_._v("新增部分 EventDispatcher 触发的事件 debug 日志")])]),_._v(" "),a("h2",{attrs:{id:"build-419-2021-9-11"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-419-2021-9-11"}},[_._v("#")]),_._v(" build 419 (2021-9-11)")]),_._v(" "),a("ul",[a("li",[_._v("修复 DB 模块在未连接数据库的时候抛出未知异常")]),_._v(" "),a("li",[_._v("修复部分情况下打包模块出现的错误")])]),_._v(" "),a("h2",{attrs:{id:"build-418-2021-9-10"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-418-2021-9-10"}},[_._v("#")]),_._v(" build 418 (2021-9-10)")]),_._v(" "),a("ul",[a("li",[_._v("修复 ZMAtomic 在 test 环境下的 bug")]),_._v(" "),a("li",[_._v("修复 MessageUtil 的报错")])]),_._v(" "),a("h2",{attrs:{id:"build-417-2021-8-29"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-417-2021-8-29"}},[_._v("#")]),_._v(" build 417 (2021-8-29)")]),_._v(" "),a("ul",[a("li",[_._v("新增 AnnotationException，统一框架内部的抛出异常的类型")]),_._v(" "),a("li",[_._v("新增 AnnotationParser 下的 "),a("code",[_._v("verifyMiddlewares()")]),_._v(" 方法")]),_._v(" "),a("li",[_._v("私有化 CQAPI 类下的内部方法")]),_._v(" "),a("li",[_._v("将 WebSocket API 响应超时时间从 60 秒缩短为 30 秒")]),_._v(" "),a("li",[_._v("修复 DB 类不能使用旧查询器的 bug")]),_._v(" "),a("li",[_._v("统一 DB 类下抛出 Exception 的类型为 ZMException 的子类")]),_._v(" "),a("li",[_._v("EventDispatcher 新增对 "),a("code",[_._v("middleware_error_policy")]),_._v(" 的处理段")]),_._v(" "),a("li",[_._v("配置文件下 "),a("code",[_._v("runtime")]),_._v(" 新增 "),a("code",[_._v("middleware_error_policy")]),_._v(" 字段")]),_._v(" "),a("li",[_._v("将 LightCache 组件抛出的异常改为 LightCacheException")]),_._v(" "),a("li",[_._v("ModuleManager 修复改配置的 "),a("code",[_._v("load_path")]),_._v(" 不生效的 bug")]),_._v(" "),a("li",[_._v("修复打包时生成的 Phar Autoload 列表出错的 bug")]),_._v(" "),a("li",[_._v("将配置的 override 改为 overwrite")]),_._v(" "),a("li",[_._v("新增解包时忽略依赖的选项（"),a("code",[_._v("--ignore-depends")]),_._v("）")]),_._v(" "),a("li",[_._v("删除众多调试日志，修改部分调试日志为 debug 级别的输出")]),_._v(" "),a("li",[_._v("修改 "),a("code",[_._v("ZM\\MySQL\\MySQLManager")]),_._v(" 下的 "),a("code",[_._v("getConnection()")]),_._v(" 为 "),a("code",[_._v("getWrapper()")])]),_._v(" "),a("li",[_._v("MySQLPool 对象新增 "),a("code",[_._v("getCount()")]),_._v(" 方法")]),_._v(" "),a("li",[_._v("新增 MySQLQueryBuilder 类（"),a("code",[_._v("doctrine/dbal")]),_._v(" 的 wrapper 类）")]),_._v(" "),a("li",[_._v("修复 MySQLStatement 封装原 dbal 组件时与连接池不兼容的 bug")]),_._v(" "),a("li",[_._v("新增 MySQLStatementWrapper 类")]),_._v(" "),a("li",[_._v("完善 MySQLWrapper 类，用作主要的查询对象控制类")]),_._v(" "),a("li",[_._v("编写外部插件加载方式（Phar 热加载功能）")]),_._v(" "),a("li",[_._v("修复 "),a("code",[_._v("ZMUtil::getClassesPsr4()")]),_._v(" 方法在遇到空扩展名文件时的报错")])])])}),[],!1,null,null,null);v.default=e.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{775:function(t,a,s){"use strict";s.r(a);var e=s(108),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"http-路由管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http-路由管理"}},[t._v("#")]),t._v(" HTTP 路由管理")]),t._v(" "),s("p",[t._v("HTTP 路由管理器用作管理炸毛框架内 "),s("code",[t._v("@RequestMapping")]),t._v(" 和静态目录的路由操作的，可在运行过程中编写添加路由。")]),t._v(" "),s("p",[t._v("类定义："),s("code",[t._v("\\ZM\\Http\\RouteManager")])]),t._v(" "),s("blockquote",[s("p",[t._v("2.3.0 版本起可用。")])]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("因为炸毛框架的路由实现是不基于跨进程的共享内存的，所以每次使用这里面的工具函数都需要单独在所有 Worker 进程中执行一次，最好的办法就是在启动框架时执行（"),s("code",[t._v("@OnStart(-1)")]),t._v(" 即可，代表此注解事件将在每个工作进程中都被执行一次）。")])]),t._v(" "),s("h2",{attrs:{id:"方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方法"}},[t._v("#")]),t._v(" 方法")]),t._v(" "),s("h3",{attrs:{id:"importroutebyannotation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#importroutebyannotation"}},[t._v("#")]),t._v(" importRouteByAnnotation()")]),t._v(" "),s("p",[t._v("通过注解类导入路由。（注：此方法一般为框架内部使用）")]),t._v(" "),s("p",[t._v("定义："),s("code",[t._v("importRouteByAnnotation(RequestMapping $vss, $method, $class, $methods_annotations)")])]),t._v(" "),s("p",[t._v("参数 "),s("code",[t._v("$vss")]),t._v("：RequestMapping 注解类，类中定义 "),s("code",[t._v("route")]),t._v(" 和 "),s("code",[t._v("request_method")]),t._v(" 即可。")]),t._v(" "),s("p",[t._v("参数 "),s("code",[t._v("$method, $class")]),t._v("：执行的目标注解事件函数位置，比如 "),s("code",[t._v("$class = \\Module\\Example\\Hello::class")]),t._v("，"),s("code",[t._v("$method = 'hitokoto'")]),t._v("。")]),t._v(" "),s("p",[t._v("参数 "),s("code",[t._v("$methods_annotations")]),t._v("：需要绑定的 Controller 注解类数组，一般数组内建议只带有一个 Controller，如 "),s("code",[t._v("[$controller]")]),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"addstaticfileroute"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#addstaticfileroute"}},[t._v("#")]),t._v(" addStaticFileRoute()")]),t._v(" "),s("p",[t._v("添加一个单目录（此目录下无子目录，只有文件）并绑定为一个路由。")]),t._v(" "),s("p",[t._v("定义："),s("code",[t._v("addStaticFileRoute($route, $path)")])]),t._v(" "),s("p",[t._v("参数 "),s("code",[t._v("$route")]),t._v("：绑定的目标路由，如 "),s("code",[t._v("/images/")]),t._v("。")]),t._v(" "),s("p",[t._v("参数 "),s("code",[t._v("$path")]),t._v("：绑定的文件目录位置，如 "),s("code",[t._v("/root/zhamao-framework-starter/zm_data/images/")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-php line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-php"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * @OnStart(-1)\n */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("onStart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("RouteManager")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addStaticFileRoute")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"/images/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("DataProvider")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getDataFolder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"images/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("h2",{attrs:{id:"属性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#属性"}},[t._v("#")]),t._v(" 属性")]),t._v(" "),s("h3",{attrs:{id:"routemanager-routes"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#routemanager-routes"}},[t._v("#")]),t._v(" RouteManager::$routes")]),t._v(" "),s("p",[t._v("此为存放路由树的变量，请谨慎操作。")]),t._v(" "),s("p",[t._v("定义："),s("code",[t._v("\\Symfony\\Component\\Routing\\RouteCollection | null")])]),t._v(" "),s("p",[t._v("炸毛框架使用了 Symfony 框架的 route 组件，有关详情请查阅 "),s("a",{attrs:{href:"https://symfony.com/doc/current/routing.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("文档"),s("OutboundLink")],1),t._v("。")])])}),[],!1,null,null,null);a.default=n.exports}}]);
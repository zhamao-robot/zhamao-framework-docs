(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{767:function(t,s,a){"use strict";a.r(s);var n=a(108),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"上下文"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#上下文"}},[t._v("#")]),t._v(" 上下文")]),t._v(" "),a("p",[t._v("上下文作为整个框架中最重要的内容之一，请务必理解和完整地阅读此部分！")]),t._v(" "),a("p",[t._v("一个上下文描述了一个事件和所关联的对象的环境。例如：你在处理 HTTP 请求的 "),a("code",[t._v("@RequestMapping")]),t._v(" 绑定的事件中，你需要获取请求的 HTTP 头和 Cookie，再比如你在处理 QQ 机器人发来的命令 "),a("code",[t._v('@CQCommand("随机数")')]),t._v(" 的时候，在这个方法内，你需要获取发来的人的 QQ 号码。以上我们将处理以上运行环境的对象叫做上下文。")]),t._v(" "),a("p",[t._v("由于 Swoole 的协程加持，我们利用了协程 ID 绑定对象来进行构造上下文。")]),t._v(" "),a("p",[t._v("以默认的机器人收发消息为例，通过对默认模块的了解，我们可以知道，在绑定 "),a("code",[t._v("@CQCommand")]),t._v(" 等类似事件后，你可以用上下文获取发来这条消息的人的 QQ 号码：")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/**\n * @CQCommand("你好")\n */')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("hello")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user_id")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUserId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reply")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"你好啊，"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$user_id")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"，很高兴认识你！"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("p",[a("code",[t._v("context()")]),t._v(" 就是获取上下文对象的全局函数，它还有简写："),a("code",[t._v("ctx()")]),t._v("。")]),t._v(" "),a("p",[t._v("当然，上下文中的方法不是每个都能在任何时候使用的。例如 "),a("code",[t._v("getUserId()")]),t._v(" 你不能在 "),a("code",[t._v("@RequestMapping")]),t._v(" 注解的函数中使用，因为它不是机器人消息的上下文。下面说明上下文对象的方法中，每个都会说明每个方法可以在哪些事件中使用：")]),t._v(" "),a("h2",{attrs:{id:"getserver-获取-server-对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getserver-获取-server-对象"}},[t._v("#")]),t._v(" getServer() - 获取 Server 对象")]),t._v(" "),a("p",[t._v("获取 Swoole WebSocker Server 对象。此对象是 Swoole 的对象，详情见 "),a("a",{attrs:{href:"https://wiki.swoole.com/#/websocket_server",target:"_blank",rel:"noopener noreferrer"}},[t._v("Swoole 文档"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("p",[t._v("可以使用的事件："),a("code",[t._v("@OnMessageEvent()")]),t._v("，"),a("code",[t._v("@OnOpenEvent()")]),t._v("，"),a("code",[t._v("@OnCloseEvent()")]),t._v("，"),a("code",[t._v("@OnStart()")]),t._v(" 以及所有 HTTP API 发来的事件："),a("code",[t._v("@CQCommand()")]),t._v("，"),a("code",[t._v("@CQMessage()")]),t._v(" 等。")]),t._v(" "),a("h2",{attrs:{id:"getframe-获取-ws-数据帧"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getframe-获取-ws-数据帧"}},[t._v("#")]),t._v(" getFrame() - 获取 WS 数据帧")]),t._v(" "),a("p",[t._v("获取 "),a("code",[t._v("\\Swoole\\Websocket\\Frame")]),t._v(" 对象，此对象是 Swoole 的对象，详情见 "),a("a",{attrs:{href:"https://wiki.swoole.com/#/websocket_server?id=swoolewebsocketframe",target:"_blank",rel:"noopener noreferrer"}},[t._v("Swoole 文档"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("p",[t._v("可以使用的事件："),a("code",[t._v("@OnMessageEvent()")]),t._v(" 以及所有 HTTP API 发来的事件："),a("code",[t._v("@CQCommand()")]),t._v("，"),a("code",[t._v("@CQMessage()")]),t._v(" 等，")]),t._v(" "),a("h2",{attrs:{id:"getfd-返回-fd-值"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getfd-返回-fd-值"}},[t._v("#")]),t._v(" getFd() - 返回 fd 值")]),t._v(" "),a("p",[t._v("获取当前连入 Swoole 服务器的连接文件描述符 ID。返回 int。一般代表连接号，可用来绑定对应链接。")]),t._v(" "),a("p",[t._v("可以使用的事件：所有 "),a("strong",[t._v("getFrame()")]),t._v(" 可以使用的，"),a("code",[t._v("@OnOpenEvent()")]),t._v("，"),a("code",[t._v("@OnCloseEvent()")])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("值得注意的是，由于机器人客户端和炸毛框架的连接是通过 WebSocket 进行的，而 WebSocket 是长连接，所以同一个机器人一次连接下收发消息所用的连接是同一个，所以 Fd 也是相同的。同理，炸毛框架的内部来区分多个机器人也是通过这一 Fd 进行判定的。")])]),t._v(" "),a("p",[t._v("代码")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/**\n * @CQCommand("测试fd")\n */')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("testfd")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reply")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"当前机器人连接的fd是："')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getFd")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"，机器人QQ是："')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRobotId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("p",[t._v("效果")]),t._v(" "),a("chat-box",{attrs:{"my-chats":[{type:2,content:"假设我们和连接55555的机器人的私聊"},{type:0,content:"测试fd"},{type:1,content:"当前机器人连接的fd是：1，机器人QQ是：55555"},{type:2,content:"假设切到了另一个机器人（66666）的私聊"},{type:0,content:"测试fd"},{type:1,content:"当前机器人连接的fd是：2，机器人QQ是：66666"}]}}),t._v(" "),a("h2",{attrs:{id:"getdata-获取事件完整数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getdata-获取事件完整数据"}},[t._v("#")]),t._v(" getData() - 获取事件完整数据")]),t._v(" "),a("p",[t._v("返回 CQHTTP 事件上报的原始数据包，已经被解析成数组，可以直接操作。")]),t._v(" "),a("p",[t._v("可以使用的事件：所有 HTTP API 发来的事件："),a("code",[t._v("@CQCommand()")]),t._v("，"),a("code",[t._v("@CQMessage()")]),t._v(" 等。")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * @CQMessage(user_id=123456)\n */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("onMessage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$data")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getData")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reply")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"消息类型是："')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"message_type"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("chat-box",{attrs:{"my-chats":[{type:2,content:"假设我是QQ为123456的用户，私聊发消息"},{type:0,content:"哈咯！！"},{type:1,content:"消息类型是：private"}]}}),t._v(" "),a("h2",{attrs:{id:"getrequest-http-请求对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getrequest-http-请求对象"}},[t._v("#")]),t._v(" getRequest() - HTTP 请求对象")]),t._v(" "),a("p",[t._v("返回 "),a("code",[t._v("\\Swoole\\Http\\Request")]),t._v(" 对象，可在 "),a("code",[t._v("@RequestMapping")]),t._v(" 中使用，获取 Cookie，请求头，GET 参数什么的。"),a("a",{attrs:{href:"https://wiki.swoole.com/#/http_server?id=httprequest",target:"_blank",rel:"noopener noreferrer"}},[t._v("Swoole 文档"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("p",[t._v("可以使用的事件："),a("code",[t._v("@RequestMapping()")]),t._v("，"),a("code",[t._v("@OnRequestEvent()")]),t._v("，"),a("code",[t._v("@OnOpenEvent()")]),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"getresponse-http-响应对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getresponse-http-响应对象"}},[t._v("#")]),t._v(" getResponse() - HTTP 响应对象")]),t._v(" "),a("p",[t._v("返回 "),a("code",[t._v("\\Swoole\\Http\\Response")]),t._v(" 对象的增强版，可在 HTTP 请求相关的事件中使用，返回内容和设置 Cookie 什么的。"),a("a",{attrs:{href:"https://wiki.swoole.com/#/http_server?id=httpresponse",target:"_blank",rel:"noopener noreferrer"}},[t._v("Swoole 文档"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("p",[t._v("可以使用的事件："),a("code",[t._v("@RequestMapping()")]),t._v("，"),a("code",[t._v("@OnRequestEvent()")]),t._v("。")]),t._v(" "),a("p",[t._v("下面是使用以上两个功能的组合示例：")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/**\n * @RequestMapping("/ping")\n */')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("ping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$name")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRequest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("??")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"unknown"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"Hello "')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("h2",{attrs:{id:"getconnection-ws-连接对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getconnection-ws-连接对象"}},[t._v("#")]),t._v(" getConnection() - WS 连接对象")]),t._v(" "),a("p",[t._v("返回此上下文相关联的 WebSocket 连接对象。详见 "),a("a",{attrs:{href:"/advanced/connect-ws-client"}},[t._v("进阶 - 接入 WebSocket 客户端")]),t._v("。")]),t._v(" "),a("p",[t._v("可以使用的事件：所有 "),a("strong",[t._v("getFrame()")]),t._v(" 可以使用的都可以使用。")]),t._v(" "),a("h2",{attrs:{id:"getcid-上下文-id"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getcid-上下文-id"}},[t._v("#")]),t._v(" getCid() - 上下文 ID")]),t._v(" "),a("p",[t._v("返回当前上下文所绑定的协程 ID，此 ID 和 "),a("code",[t._v("\\Co::getCid()")]),t._v(" 返回值一样。")]),t._v(" "),a("h2",{attrs:{id:"getrobot-获取机器人-api-对象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getrobot-获取机器人-api-对象"}},[t._v("#")]),t._v(" getRobot() - 获取机器人 API 对象")]),t._v(" "),a("p",[t._v("返回当前上下文关联的机器人 API 调用对象 "),a("RouterLink",{attrs:{to:"/component/bot/robot-api.html"}},[t._v("ZMRobot")]),t._v("。")],1),t._v(" "),a("p",[t._v("可以使用的事件：所有 HTTP API 发来的事件："),a("code",[t._v("@CQCommand()")]),t._v("，"),a("code",[t._v("@CQMessage()")]),t._v(" 等。")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRobot")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sendPrivateMsg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"发送私聊消息"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("chat-box",{attrs:{"my-chats":[{type:2,content:"正在和机器人聊天"},{type:1,content:"发送私聊消息"}]}}),t._v(" "),a("h2",{attrs:{id:"getmessage-获取消息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getmessage-获取消息"}},[t._v("#")]),t._v(" getMessage() - 获取消息")]),t._v(" "),a("p",[t._v("获取 data 数据中的 "),a("code",[t._v("message")]),t._v(" 消息，用于快速获取用户消息事件的消息内容。")]),t._v(" "),a("p",[t._v("可以使用的事件："),a("code",[t._v("@CQCommand()")]),t._v("，"),a("code",[t._v("@CQMessage")]),t._v("，"),a("code",[t._v('@CQBefore("message")')]),t._v("，"),a("code",[t._v('@CQAfter("message")')])]),t._v(" "),a("p",[t._v("代码")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * @CQMessage(group_id=33333)\n */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("groupRepeat")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reply")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getMessage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("p",[t._v("效果")]),t._v(" "),a("chat-box",{attrs:{"my-chats":[{type:2,content:"现在在群33333内，机器人已经成了复读机"},{type:0,content:"来世还做复读机！！！"},{type:1,content:"来世还做复读机！！！"},{type:0,content:"你不许复读！"},{type:1,content:"你不许复读！"}]}}),t._v(" "),a("h2",{attrs:{id:"getuserid-获取用户-qq-号"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getuserid-获取用户-qq-号"}},[t._v("#")]),t._v(" getUserId() - 获取用户 QQ 号")]),t._v(" "),a("p",[t._v("获取发消息的用户的 QQ 号码。")]),t._v(" "),a("p",[t._v("可以使用的事件：所有 "),a("strong",[t._v("含有")]),t._v(" "),a("code",[t._v("user_id")]),t._v(" 上报参数的 OneBot 事件。")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/**\n * @CQCommand("whoami")\n */')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("whoami")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reply")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"你是"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUserId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//返回：你是123456")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("h2",{attrs:{id:"getgroupid-获取-qq-群号"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getgroupid-获取-qq-群号"}},[t._v("#")]),t._v(" getGroupId() - 获取 QQ 群号")]),t._v(" "),a("p",[t._v("获取发消息来自的 QQ 群号。")]),t._v(" "),a("p",[t._v("可以使用的事件：所有含有 "),a("code",[t._v("group_id")]),t._v(" 上报参数的 OneBot 事件。")]),t._v(" "),a("h2",{attrs:{id:"getmessagetype-消息类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getmessagetype-消息类型"}},[t._v("#")]),t._v(" getMessageType() - 消息类型")]),t._v(" "),a("p",[t._v("获取消息类型，同参数 "),a("code",[t._v("message_type")]),t._v("。")]),t._v(" "),a("p",[t._v("可以使用的事件：所有 "),a("code",[t._v("post_type")]),t._v(" 为 "),a("code",[t._v("message")]),t._v(" 的响应事件，如 "),a("code",[t._v("@CQMessage")]),t._v("，"),a("code",[t._v("@CQCommand")]),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"getrobotid-机器人-qq-号"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getrobotid-机器人-qq-号"}},[t._v("#")]),t._v(" getRobotId() - 机器人 QQ 号")]),t._v(" "),a("p",[t._v("获取事件上报的机器人自己的 QQ 号码。")]),t._v(" "),a("p",[t._v("可以使用的事件：所有 OneBot 发来的事件："),a("code",[t._v("@CQCommand()")]),t._v("，"),a("code",[t._v("@CQNotice()")]),t._v(" 等。")]),t._v(" "),a("h2",{attrs:{id:"setmessage-设置消息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setmessage-设置消息"}},[t._v("#")]),t._v(" setMessage() - 设置消息")]),t._v(" "),a("p",[t._v("与 "),a("code",[t._v("getMessage()")]),t._v(" 对应，用于更改上下文中保存的事件信息，可以用于消息变更和过滤。")]),t._v(" "),a("h2",{attrs:{id:"setuserid-设置用户-id"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setuserid-设置用户-id"}},[t._v("#")]),t._v(" setUserId() - 设置用户 ID")]),t._v(" "),a("p",[t._v("与上同理，更改 "),a("code",[t._v("user_id")]),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"setgroupid-设置群号"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setgroupid-设置群号"}},[t._v("#")]),t._v(" setGroupId() - 设置群号")]),t._v(" "),a("p",[t._v("与上同理。")]),t._v(" "),a("h2",{attrs:{id:"setmessagetype-设置类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setmessagetype-设置类型"}},[t._v("#")]),t._v(" setMessageType() - 设置类型")]),t._v(" "),a("p",[t._v("与上同理，修改消息类型。")]),t._v(" "),a("h2",{attrs:{id:"setdata-设置数据包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setdata-设置数据包"}},[t._v("#")]),t._v(" setData() - 设置数据包")]),t._v(" "),a("p",[t._v("与上同理，与 "),a("code",[t._v("getData()")]),t._v(" 对应，用于更改上下文中的 "),a("code",[t._v("data")]),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"getcache-上下文缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getcache-上下文缓存"}},[t._v("#")]),t._v(" getCache() - 上下文缓存")]),t._v(" "),a("p",[t._v("获取保存在上下文中的临时缓存变量。当相关联的事件结束后，数据会从内存中被释放。用于同一事件的多个函数中的信息传递。")]),t._v(" "),a("ul",[a("li",[t._v("参数："),a("code",[t._v("$key")]),t._v("，缓存变量的键名")]),t._v(" "),a("li",[t._v("返回："),a("code",[t._v("mixed")]),t._v("，存入缓存的变量值。")])]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$a")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCache")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"block_continue"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果变量不存在，则返回 null")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("h2",{attrs:{id:"setcache-上下文缓存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setcache-上下文缓存"}},[t._v("#")]),t._v(" setCache() - 上下文缓存")]),t._v(" "),a("p",[t._v("与 "),a("code",[t._v("getCache()")]),t._v(" 对应，是设置内容的。")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setCache")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"abc"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"asdasd"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$result")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCache")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"abc"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// asdasd")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("h2",{attrs:{id:"reply-快速回复"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#reply-快速回复"}},[t._v("#")]),t._v(" reply() - 快速回复")]),t._v(" "),a("p",[t._v("快速回复当前用户消息内容。")]),t._v(" "),a("ul",[a("li",[t._v("参数1："),a("code",[t._v("$msg")]),t._v("，字符串，你要回复的消息内容")]),t._v(" "),a("li",[t._v("参数2："),a("code",[t._v("$yield = false")]),t._v("，可选，当为 "),a("code",[t._v("true")]),t._v(" 时，会协程等待后返回 "),a("strong",[t._v("消息回复")]),t._v(" 的结果，包括 API 状态码、消息 "),a("code",[t._v("message_id")]),t._v(" 等。")])]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$r")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reply")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"我又好了。"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$r")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"retcode"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("Console")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("success")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"消息发送成功！"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("h2",{attrs:{id:"finalreply-快速回复"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#finalreply-快速回复"}},[t._v("#")]),t._v(" finalReply() - 快速回复")]),t._v(" "),a("p",[t._v("快速回复用户消息，并阻止其他模块接下来继续处理此事件。")]),t._v(" "),a("p",[t._v("参数同 "),a("code",[t._v("reply()")]),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"waitmessage-等待用户消息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#waitmessage-等待用户消息"}},[t._v("#")]),t._v(" waitMessage() - 等待用户消息")]),t._v(" "),a("ul",[a("li",[t._v("参数："),a("code",[t._v('waitMessage($prompt = "", $timeout = 600, $timeout_prompt = "")')])]),t._v(" "),a("li",[t._v("用途：等待用户输入消息")])]),t._v(" "),a("p",[a("code",[t._v("$prompt")]),t._v(" 参数为回复用户的文本内容，"),a("code",[t._v("$timeout")]),t._v(" 是等待用户回复的超时时间(秒)，"),a("code",[t._v("$timeout_prompt")]),t._v(" 是超时后回复用户的文本。")]),t._v(" "),a("p",[t._v("这个功能可以让开发机器人的代码逻辑和实际贴合，避免回调地狱、拼接参数、上下文脱节等问题，比如下方的示例，可以仅仅用两行代码实现一个问答式的对话过程。")]),t._v(" "),a("p",[t._v("用法示例：")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/**\n * @CQCommand("自我介绍")\n */')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("yourName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$r")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("waitMessage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"你叫啥名字呀？"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"你都10分钟不理我了，嘤嘤嘤"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("finalReply")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"好的，可爱的机器人记住你叫 "')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$r")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('" 啦！以后多聊天哦！"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("chat-box",{attrs:{"my-chats":[{type:0,content:"自我介绍"},{type:1,content:"你叫啥名字呀？"},{type:0,content:"jerry"},{type:1,content:"好的，可爱的机器人记住你叫 jerry 啦！以后多聊天哦！"},{type:0,content:"自我介绍"},{type:1,content:"你叫啥名字呀？"},{type:2,content:"10分钟没理机器人"},{type:1,content:"你都10分钟不理我了，嘤嘤嘤"}]}}),t._v(" "),a("h2",{attrs:{id:"getargs-自动获取参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getargs-自动获取参数"}},[t._v("#")]),t._v(" getArgs() - 自动获取参数")]),t._v(" "),a("p",[t._v("为 "),a("code",[t._v("waitMessage()")]),t._v(" 的封装，目的是让机器人的回复更加智能化。最好的例子就是在框架自带的默认示例中“随机数”的例子，我们假设要写一个随机数功能，但是用户从来都是不思考就使用机器人的。抛开人工智能，我们能做的就是“专家系统”，同时让我们写的代码尽可能适配用户所说的每一句话：")]),t._v(" "),a("ul",[a("li",[t._v("随机数 1 100")]),t._v(" "),a("li",[t._v("随机数（一般不知道怎么用这个功能的人都会只说一个关键词）")]),t._v(" "),a("li",[t._v("从2到9的随机数")])]),t._v(" "),a("p",[t._v("所以，在匹配第一和第二种情况时候，我们不需要重复写代码，而第一种的话用户已经将参数给你的时候，你不需要再次使用 "),a("code",[t._v("waitMessage()")]),t._v(" 方式进行等待询问，只需要取到使用就好了。"),a("code",[t._v("getArgs()")]),t._v(" 就是做这个的。")]),t._v(" "),a("p",[t._v("定义："),a("code",[t._v("getArgs($mode, $prompt_msg)")])]),t._v(" "),a("p",[a("code",[t._v("$mode")]),t._v("：获取模式，有三种：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("ZM_MATCH_ALL")]),t._v("：效果等同于 "),a("code",[t._v("getFullArg()")]),t._v("，获取全部的内容，把空格也当作一部分")]),t._v(" "),a("li",[a("code",[t._v("ZM_MATCH_NUMBER")]),t._v("：效果等同于 "),a("code",[t._v("getNumArg()")]),t._v("，获取下一个数字参数")]),t._v(" "),a("li",[a("code",[t._v("ZM_MATCH_FIRST")]),t._v("：效果等同于 "),a("code",[t._v("getNextArg()")]),t._v("，获取下一个参数")])]),t._v(" "),a("p",[a("code",[t._v("$prompt_msg")]),t._v("：字符串，指定如果参数缺失时询问用户的内容。")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/**\n * @CQCommand("test")\n */')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("argTest1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$s")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getArgs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ZM_MATCH_FIRST")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"请输入你要传入的参数内容"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"参数内容："')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$s")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("chat-box",{attrs:{"my-chats":[{type:0,content:"test"},{type:1,content:"请输入你要传入的参数内容"},{type:0,content:"test2"},{type:1,content:"参数内容：test2"}]}}),t._v(" "),a("p",[a("code",[t._v("getArgs()")]),t._v(" 也有三层封装，在使用过程中避免麻烦的话，推荐使用下面这几种 "),a("code",[t._v("get*Arg()")]),t._v(" 方式。")]),t._v(" "),a("h2",{attrs:{id:"getfullarg"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getfullarg"}},[t._v("#")]),t._v(" getFullArg()")]),t._v(" "),a("p",[t._v("获取关键词后的整个字符串参数，包括空格，如果不存在则询问。")]),t._v(" "),a("p",[t._v("典型例子："),a("code",[t._v("复读机 你好 你好")]),t._v("，获取参数时会将 "),a("code",[t._v("你好 你好")]),t._v(" 当作一个参数来获取。")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/**\n * @CQCommand("test")\n */')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("argTest1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$s")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getFullArg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"请输入你要传入的参数内容"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"参数内容："')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$s")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("chat-box",{attrs:{"my-chats":[{type:0,content:"test abc def argtest"},{type:1,content:"参数内容：abc def argtest"},{type:0,content:"test"},{type:1,content:"请输入你要传入的参数内容"},{type:0,content:"abc def"},{type:1,content:"参数内容：abc def"}]}}),t._v(" "),a("h2",{attrs:{id:"getnextarg"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getnextarg"}},[t._v("#")]),t._v(" getNextArg()")]),t._v(" "),a("p",[t._v("获取下一个参数，分隔符可以是空格，tab。")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/**\n * @CQCommand("test")\n */')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("argTest1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$s")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getNextArg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"请输入你要传入的参数内容"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"参数内容："')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$s")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("chat-box",{attrs:{"my-chats":[{type:0,content:"test abc def argtest"},{type:1,content:"参数内容：abc"},{type:0,content:"test"},{type:1,content:"请输入你要传入的参数内容"},{type:0,content:"abc"},{type:1,content:"参数内容：abc"}]}}),t._v(" "),a("h2",{attrs:{id:"getnumarg"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getnumarg"}},[t._v("#")]),t._v(" getNumArg()")]),t._v(" "),a("blockquote",[a("p",[t._v("2.1.5 版本起可用。")])]),t._v(" "),a("p",[t._v("获取下一个数字型参数，如果 "),a("code",[t._v("is_numeric()")]),t._v(" 为 true 则获取成功，如果没有符合的则询问用户。")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/**\n * @CQCommand("test")\n */')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("argTest1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$s")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getNextArg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"请输入你要传入的数字内容"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"数字参数内容："')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$s")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("chat-box",{attrs:{"my-chats":[{type:0,content:"test abc 334 argtest"},{type:1,content:"数字参数内容：334"},{type:0,content:"test abc"},{type:1,content:"请输入你要传入的参数内容"},{type:0,content:"998"},{type:1,content:"参数内容：998"}]}}),t._v(" "),a("h2",{attrs:{id:"copy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#copy"}},[t._v("#")]),t._v(" copy()")]),t._v(" "),a("p",[t._v("获取整个上下文的所有内容的数组形式。")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$arr")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("copy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dump")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$arr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("h2",{attrs:{id:"getoption-获取匹配参数内容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getoption-获取匹配参数内容"}},[t._v("#")]),t._v(" getOption() - 获取匹配参数内容")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/**\n * @CQCommand("test")\n */')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("argTest1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('"参数内容："')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("implode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[t._v('", "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ctx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getOption")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("chat-box",{attrs:{"my-chats":[{type:0,content:"test abc 334 argtest"},{type:1,content:"参数内容：abc, 334, argtest"}]}})],1)}),[],!1,null,null,null);s.default=e.exports}}]);